<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <h2>{{ isResetMode ? 'Réinitialiser le mot de passe' : 'Mot de passe oublié' }}</h2>
      <p>{{ isResetMode ? 'Entrez votre nouveau mot de passe' : 'Recevez un lien de réinitialisation' }}</p>
    </div>

    <div class="auth-body">
      <!-- Messages -->
      <div class="alert alert-success" *ngIf="successMessage">{{ successMessage }}</div>
      <div class="alert alert-danger" *ngIf="errorMessage">{{ errorMessage }}</div>

      <!-- Formulaire Mot de passe oublié -->
      <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()" *ngIf="!isResetMode">
        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="Votre email"
            [ngClass]="{ 'is-invalid': submitted && f['email'].errors }"
          >
          <div *ngIf="submitted && f['email'].errors" class="error-message">
            <div *ngIf="f['email'].errors?.['required']">L'email est requis</div>
            <div *ngIf="f['email'].errors?.['email']">Entrez un email valide</div>
          </div>
        </div>

        <div class="form-group">
          <button type="submit" class="btn-submit" [disabled]="loading">
            <span *ngIf="loading" class="spinner"></span>
            <span *ngIf="!loading">Envoyer le lien</span>
          </button>
        </div>

        <div class="back-to-login">
          <a routerLink="/auth/login">Retour à la connexion</a>
        </div>
      </form>

      <!-- Formulaire Réinitialisation -->
      <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" *ngIf="isResetMode">
        <div class="form-group">
          <label for="password">Nouveau mot de passe</label>
          <input
            type="password"
            id="password"
            formControlName="password"
            placeholder="Votre nouveau mot de passe"
            [ngClass]="{ 'is-invalid': submitted && r['password'].errors }"
          >
          <div *ngIf="submitted && r['password'].errors" class="error-message">
            <div *ngIf="r['password'].errors?.['required']">Le mot de passe est requis</div>
            <div *ngIf="r['password'].errors?.['minlength']">Le mot de passe doit contenir au moins 6 caractères</div>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirmer le mot de passe</label>
          <input
            type="password"
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirmez votre mot de passe"
            [ngClass]="{ 'is-invalid': submitted && (r['confirmPassword'].errors || resetForm.errors?.['mismatch']) }"
          >
          <div *ngIf="submitted && r['confirmPassword'].errors" class="error-message">
            <div *ngIf="r['confirmPassword'].errors?.['required']">La confirmation est requise</div>
          </div>
          <div *ngIf="submitted && resetForm.errors?.['mismatch']" class="error-message">
            Les mots de passe ne correspondent pas
          </div>
        </div>

        <div class="form-group">
          <button type="submit" class="btn-submit" [disabled]="loading">
            <span *ngIf="loading" class="spinner"></span>
            <span *ngIf="!loading">Réinitialiser</span>
          </button>
        </div>

        <div class="back-to-login">
          <a routerLink="/auth/login">Retour à la connexion</a>
        </div>
      </form>
    </div>
  </div>
</div>
