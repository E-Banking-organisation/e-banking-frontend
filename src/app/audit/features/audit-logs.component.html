<div
  class="audit-container"
  [ngClass]="roleClass"
  *ngIf="hasAccess; else accessDenied">

  <!-- HEADER -->
  <div class="audit-header">
    <div>
      <h1>Historique dâ€™audit</h1>
      <p *ngIf="isAdmin">Supervision globale des actions du systÃ¨me</p>
      <p *ngIf="isAgent">Suivi de vos actions rÃ©centes</p>
    </div>

    <span class="role-badge">{{ currentRole }}</span>
  </div>

  <!-- ACTIONS / FILTRES -->
  <div class="audit-actions">
    <button *ngIf="isAdmin"
            (click)="loadAll()"
            [class.active]="activeFilter === 'all'">
      ğŸŒ Tous les logs
    </button>

    <button *ngIf="isAgent"
            (click)="loadMyActions()"
            [class.active]="activeFilter === 'mine'">
      ğŸ‘¤ Mes actions
    </button>

    <button (click)="loadByService('AUTH_SERVICE')">
      ğŸ” Auth Service
    </button>

    <button (click)="loadByService('ACCOUNT_SERVICE')">
      ğŸ’³ Account Service
    </button>

    <button (click)="loadBySeverity('ERROR')">
      âŒ Erreurs
    </button>

    <button (click)="loadBySeverity('CRITICAL')">
      ğŸš¨ Critiques
    </button>
  </div>

  <!-- TABLE -->
  <div class="audit-card">
    <table class="audit-table">
      <thead>
      <tr>
        <th>Date</th>
        <th>Utilisateur</th>
        <th>Service</th>
        <th>Action</th>
        <th>SÃ©vÃ©ritÃ©</th>
      </tr>
      </thead>

      <tbody>
      <tr *ngFor="let log of logs">
        <td data-label="Date">{{ log.timestamp | date:'short' }}</td>
        <td data-label="Utilisateur">{{ log.userId }}</td>
        <td data-label="Service">{{ log.serviceName }}</td>
        <td data-label="Action">{{ formatAction(log.action) }}</td>
        <td data-label="SÃ©vÃ©ritÃ©">
          <span class="badge severity-{{ log.severity.toLowerCase() }}">{{ log.severity }}</span>
        </td>
      </tr>
      </tbody>
    </table>

    <div class="last-update">
      DerniÃ¨re mise Ã  jour : {{ lastUpdate | date:'short' }}
    </div>
  </div>

</div>

<!-- ACCESS DENIED -->
<ng-template #accessDenied>
  <div class="access-denied">
    <h2>AccÃ¨s refusÃ©</h2>
    <p>Vous nâ€™avez pas les droits nÃ©cessaires</p>
    <button (click)="goBack()">Retour</button>
  </div>
</ng-template>
